# å°ˆæ¡ˆéœ€æ±‚ç¬¦åˆåº¦é©—è­‰å ±å‘Š

## ğŸ“Š éœ€æ±‚æ–‡æª” vs å¯¦éš›æ•¸æ“šå°æ¯”

### 3.2.1 è»Ÿé«”åº¦é‡æŒ‡æ¨™ (Metrics)

#### 1. WMC (Weighted Methods per Class)

**éœ€æ±‚æ–‡æª”è²ç¨±**:
- ç¸½è¨ˆ > 230 (é”æˆç›®æ¨™ > 200)
- è¤‡é›œåº¦é›†ä¸­åœ¨ WinStrategy èˆ‡ ActionProcessor

**å¯¦éš›æ•¸æ“š** (å¾ Jacoco å ±å‘Š):
- **ç¸½è¤‡é›œåº¦ (Total Complexity)**: 584 (102 æœªè¦†è“‹ + 482 å·²è¦†è“‹)
- **å„é¡åˆ¥è¤‡é›œåº¦**:
  - WinStrategy: 61 (18 æœªè¦†è“‹ + 43 å·²è¦†è“‹)
  - ActionProcessor: 59 (13 æœªè¦†è“‹ + 46 å·²è¦†è“‹)
  - ScoringCalculator: 58 (5 æœªè¦†è“‹ + 53 å·²è¦†è“‹)
  - WebSocketGameSession: 115 (37 æœªè¦†è“‹ + 78 å·²è¦†è“‹)
  - HandValidator: 33 (5 æœªè¦†è“‹ + 28 å·²è¦†è“‹)
  - å…¶ä»–é¡åˆ¥: 258

**é©—è­‰çµæœ**: âš ï¸ **éƒ¨åˆ†ç¬¦åˆ**
- ç¸½è¤‡é›œåº¦ 584 > 230 âœ…
- ä½† WMC é€šå¸¸æŒ‡ã€Œæ¯å€‹é¡åˆ¥çš„æ–¹æ³•æ•¸åŠ æ¬Šç¸½å’Œã€ï¼Œè€Œéã€Œç¸½è¤‡é›œåº¦ã€
- å¾ `Project issues and solutions.md` ä¼°ç®—çš„ WMC ç´„ 230ï¼Œé€™æ˜¯åˆç†çš„
- **å»ºè­°**: æ–‡æª”æ‡‰æ˜ç¢ºèªªæ˜æ˜¯ã€Œç¸½è¤‡é›œåº¦ã€è€Œéã€ŒWMCã€ï¼Œæˆ–ä½¿ç”¨ã€ŒCyclomatic Complexityã€è¡“èª

---

#### 2. å–®å…ƒæ¸¬è©¦æ•¸é‡

**éœ€æ±‚æ–‡æª”è²ç¨±**:
- ç¸½è¨ˆ 67 å€‹æ¸¬è©¦æ¡ˆä¾‹ (é”æˆç›®æ¨™ >= 50)

**å¯¦éš›æ•¸æ“š**:
- **ç¸½æ¸¬è©¦æ•¸**: **311 å€‹** âœ…
- é€šé: 311 å€‹
- å¤±æ•—: 0 å€‹
- éŒ¯èª¤: 0 å€‹

**é©—è­‰çµæœ**: âŒ **ä¸ç¬¦åˆï¼ˆå¯¦éš›é è¶…æ–‡æª”ï¼‰**
- å¯¦éš›æ¸¬è©¦æ•¸ 311 å€‹ï¼Œé è¶…æ–‡æª”è²ç¨±çš„ 67 å€‹
- **å»ºè­°**: æ›´æ–°æ–‡æª”ç‚ºã€Œç¸½è¨ˆ 311 å€‹æ¸¬è©¦æ¡ˆä¾‹ (é”æˆç›®æ¨™ >= 50ï¼Œè¶…æ¨™ 522%)ã€

---

### 3.2.2 æ¸¬è©¦è¦†è“‹ç‡å ±å‘Š (Jacoco)

#### 3. Branch Coverage

**éœ€æ±‚æ–‡æª”è²ç¨±**:
- Branch Coverage: **92%** (ç›®æ¨™ >= 90%)

**å¯¦éš›æ•¸æ“š** (å¾ Jacoco å ±å‘Š):
- **æ•´é«”åˆ†æ”¯è¦†è“‹ç‡**: **80%** (122 æœªè¦†è“‹ / 641 ç¸½åˆ†æ”¯)
- **å„å¥—ä»¶åˆ†æ”¯è¦†è“‹ç‡**:
  - com.mahjong.logic: **85%** (65 æœªè¦†è“‹ / 438 ç¸½åˆ†æ”¯) âœ…
  - com.mahjong.server: **73%** (52 æœªè¦†è“‹ / 197 ç¸½åˆ†æ”¯)
  - com.mahjong.client: **16%** (5 æœªè¦†è“‹ / 6 ç¸½åˆ†æ”¯)
  - com.mahjong.model: **n/a** (ç„¡åˆ†æ”¯)

**é©—è­‰çµæœ**: âŒ **ä¸ç¬¦åˆ**
- å¯¦éš›æ•´é«”åˆ†æ”¯è¦†è“‹ç‡ 80%ï¼Œä½æ–¼æ–‡æª”è²ç¨±çš„ 92%
- ä½†æ ¸å¿ƒé‚è¼¯å¥—ä»¶ (com.mahjong.logic) é”åˆ° 85%ï¼Œæ¥è¿‘ç›®æ¨™
- **å»ºè­°**: 
  - æ›´æ–°æ–‡æª”ç‚ºã€Œæ•´é«” Branch Coverage: 80%ã€
  - æˆ–èªªæ˜ã€Œæ ¸å¿ƒé‚è¼¯ (com.mahjong.logic) Branch Coverage: 85%ã€

---

#### 4. Line Coverage

**éœ€æ±‚æ–‡æª”è²ç¨±**:
- Line Coverage: **87%**

**å¯¦éš›æ•¸æ“š** (å¾ Jacoco å ±å‘Š):
- **æ•´é«”è¡Œè¦†è“‹ç‡**: **84%** (206 æœªè¦†è“‹ / 1,267 ç¸½è¡Œ)
- **å„å¥—ä»¶è¡Œè¦†è“‹ç‡**:
  - com.mahjong.logic: **92%** (48 æœªè¦†è“‹ / 594 ç¸½è¡Œ) âœ…
  - com.mahjong.server: **82%** (131 æœªè¦†è“‹ / 612 ç¸½è¡Œ)
  - com.mahjong.client: **31%** (26 æœªè¦†è“‹ / 38 ç¸½è¡Œ)
  - com.mahjong.model: **95%** (1 æœªè¦†è“‹ / 23 ç¸½è¡Œ)

**é©—è­‰çµæœ**: âš ï¸ **æ¥è¿‘ä½†ç•¥ä½**
- å¯¦éš›æ•´é«”è¡Œè¦†è“‹ç‡ 84%ï¼Œç•¥ä½æ–¼æ–‡æª”è²ç¨±çš„ 87%
- æ ¸å¿ƒé‚è¼¯å¥—ä»¶é”åˆ° 92%ï¼Œè¶…éç›®æ¨™
- **å»ºè­°**: æ›´æ–°æ–‡æª”ç‚ºã€Œæ•´é«” Line Coverage: 84%ã€æˆ–ã€Œæ ¸å¿ƒé‚è¼¯ Line Coverage: 92%ã€

---

## ğŸ“‹ ç¸½çµèˆ‡å»ºè­°

### ç¬¦åˆåº¦è©•åˆ†

| æŒ‡æ¨™ | æ–‡æª”è²ç¨± | å¯¦éš›æ•¸æ“š | ç¬¦åˆåº¦ | å‚™è¨» |
|------|---------|---------|--------|------|
| WMC | > 230 | 584 (ç¸½è¤‡é›œåº¦) | âš ï¸ éƒ¨åˆ† | éœ€æ˜ç¢ºè¡“èªå®šç¾© |
| æ¸¬è©¦æ•¸é‡ | 67 | **311** | âŒ ä¸ç¬¦ | å¯¦éš›é è¶…æ–‡æª” |
| Branch Coverage | 92% | **80%** | âŒ ä¸ç¬¦ | éœ€æ›´æ–°æ•¸æ“š |
| Line Coverage | 87% | **84%** | âš ï¸ æ¥è¿‘ | ç•¥ä½ä½†å¯æ¥å— |

### å»ºè­°ä¿®æ­£

1. **æ›´æ–°æ¸¬è©¦æ•¸é‡**: 67 â†’ **311 å€‹æ¸¬è©¦æ¡ˆä¾‹**
2. **æ›´æ–°åˆ†æ”¯è¦†è“‹ç‡**: 92% â†’ **80%** (æ•´é«”) æˆ– **85%** (æ ¸å¿ƒé‚è¼¯)
3. **æ›´æ–°è¡Œè¦†è“‹ç‡**: 87% â†’ **84%** (æ•´é«”) æˆ– **92%** (æ ¸å¿ƒé‚è¼¯)
4. **æ˜ç¢º WMC å®šç¾©**: èªªæ˜æ˜¯ã€Œç¸½è¤‡é›œåº¦ã€é‚„æ˜¯ã€ŒWMC ç¸½å’Œã€

### ä¿®æ­£å¾Œçš„å»ºè­°æ–‡æª”å…§å®¹

```markdown
3.2 æ¸¬è©¦çµæœèªªæ˜
3.2.1 è»Ÿé«”åº¦é‡æŒ‡æ¨™ (Metrics)
WMC (Weighted Methods per Class / ç¸½è¤‡é›œåº¦)ï¼š ç¸½è¨ˆ 584 (é”æˆç›®æ¨™ > 200)ã€‚
åˆ†æï¼šè¤‡é›œåº¦é›†ä¸­åœ¨ WinStrategy (61) èˆ‡ ActionProcessor (59)ï¼Œé¡¯ç¤ºæ ¸å¿ƒé‚è¼¯å…·å‚™è¶³å¤ çš„æ·±åº¦ã€‚
å–®å…ƒæ¸¬è©¦æ•¸é‡ï¼š ç¸½è¨ˆ 311 å€‹æ¸¬è©¦æ¡ˆä¾‹ (é”æˆç›®æ¨™ >= 50ï¼Œè¶…æ¨™ 522%)ã€‚

3.2.2 æ¸¬è©¦è¦†è“‹ç‡å ±å‘Š (Jacoco)
æœ¬å°ˆæ¡ˆå–®å…ƒæ¸¬è©¦è¦†è“‹ç‡æ¥µé«˜ï¼Œé‡é»é‚è¼¯é¡åˆ¥çš†é”æ¨™ã€‚
æ•´é«” Branch Coverage: 80% (ç›®æ¨™ >= 90%ï¼Œæ ¸å¿ƒé‚è¼¯ com.mahjong.logic é”åˆ° 85%)
æ•´é«” Line Coverage: 84% (æ ¸å¿ƒé‚è¼¯ com.mahjong.logic é”åˆ° 92%)
```

---

**å ±å‘Šç”Ÿæˆæ™‚é–“**: 2024å¹´  
**æ•¸æ“šä¾†æº**: `target/site/jacoco/index.html` å’Œ `target/site/jacoco/jacoco.csv`

